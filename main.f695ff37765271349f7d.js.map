{"version":3,"sources":["webpack:///./js/apiService.js","webpack:///./index.js","webpack:///./templates/photo-card.hbs"],"names":["ImagesApiService","this","searchQuery","page","fetchImages","fetch","BASE_URL","response","json","then","data","incrementPage","hits","resetPage","newQuery","refs","cardContainer","document","querySelector","searchForm","sentinel","imagesApiService","appendCardsMarkup","insertAdjacentHTML","cardTpl","addEventListener","e","preventDefault","query","currentTarget","elements","value","error","title","text","delay","innerHTML","catch","notice","IntersectionObserver","entries","forEach","entry","isIntersecting","rootMargin","observe","event","imgTag","target","nodeName","imgSrc","dataset","source","console","log","instance","basicLightbox","show","Handlebars","module","exports","template","container","depth0","helpers","partials","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","stack1","program","noop"],"mappings":"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","file":"main.f695ff37765271349f7d.js","sourcesContent":["const API_KEY = '20752837-5cf2428c2df3b00b35cf66bdb';\nconst BASE_URL = 'https://pixabay.com/api';\n\nexport default class ImagesApiService{\n    constructor() {\n        this.searchQuery = '';\n        this.page = 1;\n     }\n\n    // fetchImages() { \n    //     const url = `${BASE_URL}/?image_type=photo&orientation=horizontal&q=${this.searchQuery}&page=${this.page}&per_page=12&key=${API_KEY}`;\n\n    //    return fetch(url)\n    //        .then(response => {\n    //            if (!response.ok) {\n    //                return\n    //            }\n    //         return response.json()\n    //        })\n    //        .then(({ hits }) => {\n                \n    //             this.incrementPage();\n                \n    //            return hits;\n    //         })\n        \n    // }\n\n        async fetchImages() { \n        const response = await  fetch(`${BASE_URL}/?image_type=photo&orientation=horizontal&q=${this.searchQuery}&page=${this.page}&per_page=12&key=${API_KEY}`);\n        \n            return response.json()\n                .then(data => { \n            //          if (data.hits.length === 0) {\n            //              console.log('error')\n            //              return;\n            // }\n            this.incrementPage();\n            return data.hits})\n        \n    }\n\n    incrementPage() {\n        this.page += 1;\n    }\n\n    resetPage() {\n        this.page = 1;\n    }\n\n    get query() {\n        return this.searchQuery;\n    }\n\n    set query(newQuery) {\n        this.searchQuery = newQuery;\n    }\n}\n\n ","import './styles.css';\nimport '@pnotify/core/dist/PNotify.css';\nimport '@pnotify/mobile/dist/PNotifyMobile.css';\nimport { notice, error } from '@pnotify/core';\nimport '@pnotify/core/dist/BrightTheme.css';\n// const debounce = require('lodash.debounce');\nimport * as basicLightbox from 'basiclightbox';\nimport 'basiclightbox/src/styles/main.scss';\n\n\nimport ImagesApiService from './js/apiService.js';\nimport cardTpl from './templates/photo-card.hbs';\n\nconst refs = {\n    cardContainer: document.querySelector('.js-gallery-container'),\n    searchForm: document.querySelector('.search-form'),\n    sentinel: document.querySelector('#sentinel'),\n    // loadMoreBtn: document.querySelector('[data-action = \"load-more\"]')\n}\n\nconst imagesApiService = new  ImagesApiService();\nrefs.searchForm.addEventListener('submit', onSearch);\n// refs.loadMoreBtn.addEventListener('click', onLoadMore);\n\n\n\nfunction onSearch(e){ \n    e.preventDefault();\n    \n    imagesApiService.query = e.currentTarget.elements.query.value;\n    if (imagesApiService.query === '') {\n        return error({\n          title: 'O, нет !',\n          text: 'Заполни строку поиска!',\n          delay: 1200,\n  })\n    }\n    imagesApiService.resetPage();\n    imagesApiService.fetchImages()\n        .then(hits => {\n        clearCardsContainer();\n        appendCardsMarkup(hits);\n            // refs.loadMoreBtn.classList.remove('hidden');\n        })\n        .catch(error => {\n            notice({\n                title: 'Упс !',\n                text: 'Нет такого изображения! Попробуй еще раз!',\n                delay: 1200,\n            })\n        }) \n\n};\n// function onLoadMore() {\n//     imagesApiService.fetchImages().then(appendCardsMarkup);\n   \n// }\n \nfunction appendCardsMarkup(hits) { \n    refs.cardContainer.insertAdjacentHTML('beforeend', cardTpl(hits));\n    \n}\n\nfunction clearCardsContainer() { \n    refs.cardContainer.innerHTML = '';\n    // refs.loadMoreBtn.classList.add('hidden');\n\n}\n\nconst onEntry = entries => {\n    entries.forEach(entry => {\n        if (entry.isIntersecting && imagesApiService.query !== '') {\n        imagesApiService.fetchImages().then(appendCardsMarkup);\n        }\n    })\n}\nconst options = {\n    rootMargin: '500px'\n}\nconst observer = new IntersectionObserver(onEntry, options)\n\n\nobserver.observe(refs.sentinel);\n\nconst onModal = event => {\n  const imgTag = event.target;\n  if (imgTag.nodeName !== 'IMG') return;\n    const imgSrc = imgTag.dataset.source;\n    console.log(imgSrc);\n  const instance = basicLightbox.create(\n    `<img src=${imgSrc} alt=\"\" width=\"100%\"/>`,\n  );\n    console.log(instance)\n  instance.show();\n};\n\nrefs.cardContainer.addEventListener('click', onModal);\n\n","var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"1\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=container.hooks.helperMissing, alias3=\"function\", alias4=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"photo-card\\\">\\n    <img src=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"webformatURL\") || (depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"webformatURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":3,\"column\":14},\"end\":{\"line\":3,\"column\":30}}}) : helper)))\n    + \"\\\" alt=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"tags\") || (depth0 != null ? lookupProperty(depth0,\"tags\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"tags\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":3,\"column\":37},\"end\":{\"line\":3,\"column\":45}}}) : helper)))\n    + \"\\\" data-source=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"largeImageURL\") || (depth0 != null ? lookupProperty(depth0,\"largeImageURL\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"largeImageURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":3,\"column\":60},\"end\":{\"line\":3,\"column\":77}}}) : helper)))\n    + \"\\\" />\\n\\n    <div class=\\\"stats\\\">\\n        <p class=\\\"stats-item\\\">\\n            <i class=\\\"material-icons\\\">thumb_up</i>\\n            \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"likes\") || (depth0 != null ? lookupProperty(depth0,\"likes\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"likes\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":8,\"column\":12},\"end\":{\"line\":8,\"column\":21}}}) : helper)))\n    + \"\\n        </p>\\n        <p class=\\\"stats-item\\\">\\n            <i class=\\\"material-icons\\\">visibility</i>\\n            \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"views\") || (depth0 != null ? lookupProperty(depth0,\"views\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"views\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":12,\"column\":12},\"end\":{\"line\":12,\"column\":21}}}) : helper)))\n    + \"\\n        </p>\\n        <p class=\\\"stats-item\\\">\\n            <i class=\\\"material-icons\\\">comment</i>\\n            \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"comments\") || (depth0 != null ? lookupProperty(depth0,\"comments\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"comments\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":16,\"column\":12},\"end\":{\"line\":16,\"column\":24}}}) : helper)))\n    + \"\\n        </p>\\n        <p class=\\\"stats-item\\\">\\n            <i class=\\\"material-icons\\\">cloud_download</i>\\n            \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"downloads\") || (depth0 != null ? lookupProperty(depth0,\"downloads\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"downloads\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":20,\"column\":12},\"end\":{\"line\":20,\"column\":25}}}) : helper)))\n    + \"\\n        </p>\\n    </div>\\n</div>\\n\";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return ((stack1 = lookupProperty(helpers,\"each\").call(depth0 != null ? depth0 : (container.nullContext || {}),depth0,{\"name\":\"each\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data,\"loc\":{\"start\":{\"line\":1,\"column\":0},\"end\":{\"line\":24,\"column\":9}}})) != null ? stack1 : \"\");\n},\"useData\":true});"],"sourceRoot":""}